poetry run fbuild ThomsonDropPercents
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:850: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:183: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/scanpy/preprocessing/_normalization.py:169: UserWarning: Received a view of an AnnData. Making a copy.
  view_to_actual(adata)
make: *** [makefile:28: output/figureThomsonDropPercents.svg] Terminated
poetry run fbuild ThomsonDrop
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:850: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:183: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/scanpy/preprocessing/_normalization.py:169: UserWarning: Received a view of an AnnData. Making a copy.
  view_to_actual(adata)
['Myeloid Suppressors' 'Classical Monocytes' 'Activated Monocytes'
 'Memory T Cells' 'Macrophages' 'Naive B Cells' 'Myeloid DCs'
 'Memory B Cells' 'Intermediate Monocytes' 'NK Cells' 'cDCs' 'pDCs'
 'Cytotoxic T Cells']
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:07,  1.25s/it]  1%|          | 2/200 [00:02<03:18,  1.00s/it]  2%|▏         | 3/200 [00:02<02:58,  1.11it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:45,  1.19it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:39,  1.22it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:35,  1.25it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:34,  1.25it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:33,  1.25it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:35,  1.23it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:30,  1.26it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:31,  1.25it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:10<02:34,  1.22it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:56,  1.06it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:12<02:54,  1.07it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:13,  1.05s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:14<02:56,  1.04it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:17,  1.08s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<03:00,  1.01it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:59,  1.02it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843334103
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:23,  1.39it/s]  1%|          | 2/200 [00:01<02:22,  1.39it/s]  2%|▏         | 3/200 [00:02<02:21,  1.40it/s, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:02<02:20,  1.39it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:03<02:22,  1.37it/s, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:04<02:20,  1.38it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:05<02:19,  1.38it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:05<02:19,  1.38it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:06<02:18,  1.38it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:07<02:17,  1.38it/s, R2X=0.0214, Δ=5.42e-6]  5%|▌         | 10/200 [00:07<02:31,  1.26it/s, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3990366599883353
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:36,  1.27it/s]  1%|          | 2/200 [00:01<02:36,  1.26it/s]  2%|▏         | 3/200 [00:02<02:37,  1.25it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:40,  1.22it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:44,  1.19it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:45,  1.17it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:45,  1.16it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:44,  1.17it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:40,  1.19it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:33,  1.24it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:30,  1.25it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:29,  1.26it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:56,  1.06it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<02:45,  1.12it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:07,  1.01s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:13<02:54,  1.06it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:13,  1.06s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<02:59,  1.02it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:56,  1.03it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433340294
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:23,  1.39it/s]  1%|          | 2/200 [00:01<02:24,  1.37it/s]  2%|▏         | 3/200 [00:02<02:24,  1.37it/s, R2X=0.0212, Δ=0.000234]  2%|▏         | 4/200 [00:02<02:24,  1.35it/s, R2X=0.0213, Δ=9.35e-5]   2%|▎         | 5/200 [00:03<02:25,  1.34it/s, R2X=0.0213, Δ=4.47e-5]  3%|▎         | 6/200 [00:04<02:26,  1.33it/s, R2X=0.0213, Δ=2.35e-5]  4%|▎         | 7/200 [00:05<02:27,  1.31it/s, R2X=0.0213, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:30,  1.27it/s, R2X=0.0214, Δ=1.26e-5]  4%|▍         | 9/200 [00:06<02:31,  1.26it/s, R2X=0.0214, Δ=3.87e-6]  5%|▌         | 10/200 [00:07<02:32,  1.24it/s, R2X=0.0214, Δ=5.48e-6]  5%|▌         | 10/200 [00:08<02:43,  1.17it/s, R2X=0.0214, Δ=9.72e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3453815889911174
Number of Naive B Cells: 178
Number of Naive B Cells in CTRL4: 3
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:56,  1.13it/s]  1%|          | 2/200 [00:01<02:55,  1.13it/s]  2%|▏         | 3/200 [00:02<02:52,  1.14it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:49,  1.16it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:42,  1.20it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:44,  1.18it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:43,  1.18it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:49,  1.13it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:53,  1.10it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:53,  1.10it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:52,  1.09it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:10<02:47,  1.12it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<03:15,  1.05s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:12<03:08,  1.01s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:14<03:25,  1.11s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:15<03:09,  1.03s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:16<03:29,  1.15s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:18<03:48,  1.26s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:19<03:16,  1.08s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843334143
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:41,  1.23it/s]  1%|          | 2/200 [00:01<02:51,  1.15it/s]  2%|▏         | 3/200 [00:02<02:51,  1.15it/s, R2X=0.0212, Δ=0.000233]  2%|▏         | 4/200 [00:03<02:50,  1.15it/s, R2X=0.0213, Δ=9.99e-5]   2%|▎         | 5/200 [00:04<02:50,  1.14it/s, R2X=0.0213, Δ=4.2e-5]   3%|▎         | 6/200 [00:05<02:54,  1.11it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:06<02:54,  1.10it/s, R2X=0.0214, Δ=1.05e-5]  4%|▍         | 8/200 [00:07<03:00,  1.07it/s, R2X=0.0214, Δ=1.12e-5]  4%|▍         | 9/200 [00:08<03:02,  1.05it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:09<02:59,  1.06it/s, R2X=0.0214, Δ=5.36e-6]  5%|▌         | 10/200 [00:10<03:13,  1.02s/it, R2X=0.0214, Δ=8.57e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.39965521203543997
Number of NK Cells: 686
Number of NK Cells in CTRL4: 10
  0%|          | 0/200 [00:00<?, ?it/s]poetry run fbuild ThomsonDropPercents
  0%|          | 1/200 [00:01<05:14,  1.58s/it]  1%|          | 2/200 [00:02<04:32,  1.37s/it]  2%|▏         | 3/200 [00:04<04:33,  1.39s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:05<04:30,  1.38s/it, R2X=0.0213, Δ=0.000114]/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:850: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
  2%|▎         | 5/200 [00:06<04:29,  1.38s/it, R2X=0.0213, Δ=4.64e-5] /home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:183: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/scanpy/preprocessing/_normalization.py:169: UserWarning: Received a view of an AnnData. Making a copy.
  view_to_actual(adata)
  3%|▎         | 6/200 [00:08<04:27,  1.38s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:09<04:25,  1.38s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:11<04:20,  1.36s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:12<04:15,  1.34s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:13<04:15,  1.34s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:15<04:13,  1.34s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:16<04:09,  1.33s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:18<04:56,  1.59s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:20<04:51,  1.57s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:22<05:32,  1.80s/it, R2X=0.0214, Δ=1.42e-6]['Myeloid Suppressors' 'Classical Monocytes' 'Activated Monocytes'
 'Memory T Cells' 'Macrophages' 'Naive B Cells' 'Myeloid DCs'
 'Memory B Cells' 'Intermediate Monocytes' 'NK Cells' 'cDCs' 'pDCs'
 'Cytotoxic T Cells']
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 16/200 [00:24<05:22,  1.75s/it, R2X=0.0214, Δ=1.27e-6]  0%|          | 1/200 [00:01<06:37,  2.00s/it]  1%|          | 2/200 [00:04<06:54,  2.09s/it]  8%|▊         | 17/200 [00:27<06:44,  2.21s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:28<06:15,  2.06s/it, R2X=0.0214, Δ=1.04e-6]  2%|▏         | 3/200 [00:05<06:27,  1.97s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:07<06:01,  1.84s/it, R2X=0.0213, Δ=0.000114]  9%|▉         | 18/200 [00:31<05:19,  1.75s/it, R2X=0.0214, Δ=9.45e-7]
  2%|▎         | 5/200 [00:09<05:44,  1.77s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:11<05:50,  1.81s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:12<05:36,  1.74s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:14<05:27,  1.71s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:15<05:13,  1.64s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:17<04:51,  1.53s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:18<04:50,  1.54s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:20<04:39,  1.49s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:22<05:15,  1.69s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:23<05:07,  1.65s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:26<05:42,  1.85s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:27<05:15,  1.71s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:29<05:50,  1.91s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:31<05:17,  1.75s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:33<05:38,  1.86s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843332976
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:24,  1.33s/it]  1%|          | 2/200 [00:02<04:19,  1.31s/it]  2%|▏         | 3/200 [00:03<04:03,  1.24s/it, R2X=0.0211, Δ=0.000203]  2%|▏         | 4/200 [00:05<04:09,  1.27s/it, R2X=0.0212, Δ=0.000118]  2%|▎         | 5/200 [00:06<04:04,  1.25s/it, R2X=0.0213, Δ=4.94e-5]   3%|▎         | 6/200 [00:07<04:00,  1.24s/it, R2X=0.0213, Δ=2.46e-5]  4%|▎         | 7/200 [00:08<03:51,  1.20s/it, R2X=0.0213, Δ=1.25e-5]  4%|▍         | 8/200 [00:09<03:49,  1.20s/it, R2X=0.0213, Δ=1.18e-5]  4%|▍         | 9/200 [00:10<03:43,  1.17s/it, R2X=0.0213, Δ=2.73e-6]  5%|▌         | 10/200 [00:12<03:45,  1.19s/it, R2X=0.0213, Δ=8.29e-6]  5%|▌         | 10/200 [00:13<04:17,  1.35s/it, R2X=0.0213, Δ=6.18e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Reducing acceleration.
Degeneracy score: -0.32591718433341826
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:11,  1.26s/it]  1%|          | 2/200 [00:02<03:45,  1.14s/it]  2%|▏         | 3/200 [00:03<03:17,  1.00s/it, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:03<02:59,  1.09it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:04<02:50,  1.14it/s, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:05<02:33,  1.26it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:06<02:37,  1.23it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:06<02:33,  1.25it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:07<02:35,  1.22it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:08<02:28,  1.28it/s, R2X=0.0214, Δ=5.42e-6]Degeneracy score: -0.42939721306181683
Number of DCs: 668
Number of DCs in CTRL4: 13
  0%|          | 0/200 [00:00<?, ?it/s]  5%|▌         | 10/200 [00:09<02:59,  1.06it/s, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  0%|          | 1/200 [00:00<03:06,  1.07it/s]  1%|          | 2/200 [00:01<03:13,  1.03it/s]  2%|▏         | 3/200 [00:02<03:12,  1.03it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<03:15,  1.00it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<03:11,  1.02it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<03:01,  1.07it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<03:09,  1.02it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:37,  1.13s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:31,  1.10s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:12,  1.01s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:12<04:08,  1.31s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:35,  1.14s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:14<03:48,  1.22s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:15<03:28,  1.12s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:16<03:46,  1.22s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:17<03:25,  1.12s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<03:51,  1.27s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:20<03:31,  1.16s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:21<03:38,  1.20s/it, R2X=0.0214, Δ=9.45e-7]
Degeneracy score: -0.39903665998823823
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:46,  1.19it/s]  1%|          | 2/200 [00:01<03:17,  1.00it/s]  2%|▏         | 3/200 [00:02<03:10,  1.03it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:24,  1.04s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:25,  1.05s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:13,  1.00it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<03:05,  1.04it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<03:01,  1.06it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:08<02:57,  1.08it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:09<02:48,  1.13it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:10<02:44,  1.15it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:11<02:42,  1.16it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:12<03:12,  1.03s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:13<03:01,  1.02it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:14<03:32,  1.15s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:15<03:16,  1.07s/it, R2X=0.0214, Δ=1.27e-6]Reducing acceleration.
Degeneracy score: -0.32591718433340006
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 17/200 [00:18<04:15,  1.40s/it, R2X=0.0214, Δ=1.15e-6]  0%|          | 1/200 [00:01<04:15,  1.28s/it]  9%|▉         | 18/200 [00:19<03:58,  1.31s/it, R2X=0.0214, Δ=1.04e-6]  1%|          | 2/200 [00:02<04:00,  1.21s/it]  2%|▏         | 3/200 [00:03<03:37,  1.10s/it, R2X=0.0211, Δ=0.000196]  9%|▉         | 18/200 [00:20<03:32,  1.17s/it, R2X=0.0214, Δ=9.45e-7]
  2%|▏         | 4/200 [00:04<03:21,  1.03s/it, R2X=0.0212, Δ=0.000109]  2%|▎         | 5/200 [00:05<03:02,  1.07it/s, R2X=0.0213, Δ=6.35e-5]   3%|▎         | 6/200 [00:05<02:49,  1.14it/s, R2X=0.0213, Δ=2.53e-5]  4%|▎         | 7/200 [00:06<02:40,  1.20it/s, R2X=0.0213, Δ=1.21e-5]  4%|▍         | 8/200 [00:07<02:36,  1.23it/s, R2X=0.0213, Δ=1.31e-5]  4%|▍         | 9/200 [00:08<02:31,  1.26it/s, R2X=0.0213, Δ=2.77e-6]  5%|▌         | 10/200 [00:08<02:30,  1.26it/s, R2X=0.0214, Δ=8.47e-6]  5%|▌         | 10/200 [00:09<03:05,  1.02it/s, R2X=0.0214, Δ=9.26e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Reducing acceleration.
Degeneracy score: -0.3259171843333764
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:57,  1.12it/s]  1%|          | 2/200 [00:01<02:51,  1.15it/s]  2%|▏         | 3/200 [00:02<02:53,  1.14it/s, R2X=0.0212, Δ=0.000244]Degeneracy score: -0.41244863577464846
Number of pDCs: 213
Number of pDCs in CTRL4: 5
  0%|          | 0/200 [00:00<?, ?it/s]  2%|▏         | 4/200 [00:03<02:58,  1.10it/s, R2X=0.0213, Δ=8.64e-5]   0%|          | 1/200 [00:01<04:36,  1.39s/it]  2%|▎         | 5/200 [00:05<03:35,  1.11s/it, R2X=0.0213, Δ=4.16e-5]  1%|          | 2/200 [00:03<06:28,  1.96s/it]  3%|▎         | 6/200 [00:07<05:03,  1.56s/it, R2X=0.0213, Δ=2.27e-5]  2%|▏         | 3/200 [00:06<07:03,  2.15s/it, R2X=0.0212, Δ=0.000212]  4%|▎         | 7/200 [00:09<05:53,  1.83s/it, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:12<06:09,  1.93s/it, R2X=0.0214, Δ=1.08e-5]  2%|▏         | 4/200 [00:09<08:08,  2.49s/it, R2X=0.0213, Δ=0.000114]  4%|▍         | 9/200 [00:13<06:06,  1.92s/it, R2X=0.0214, Δ=3.65e-6]  2%|▎         | 5/200 [00:11<07:40,  2.36s/it, R2X=0.0213, Δ=4.64e-5]   5%|▌         | 10/200 [00:15<05:48,  1.84s/it, R2X=0.0214, Δ=5.42e-6]  3%|▎         | 6/200 [00:13<07:33,  2.34s/it, R2X=0.0213, Δ=2.45e-5]  5%|▌         | 10/200 [00:17<05:29,  1.73s/it, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  4%|▎         | 7/200 [00:16<08:01,  2.49s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:18<08:05,  2.53s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:19<06:32,  2.05s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:20<05:27,  1.73s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:22<04:46,  1.51s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:23<04:19,  1.38s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:24<04:40,  1.50s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:25<04:16,  1.38s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:27<04:22,  1.42s/it, R2X=0.0214, Δ=1.42e-6]Degeneracy score: -0.3990366599882469
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 16/200 [00:28<04:09,  1.36s/it, R2X=0.0214, Δ=1.27e-6]  0%|          | 1/200 [00:01<04:42,  1.42s/it]  1%|          | 2/200 [00:02<04:52,  1.47s/it]  8%|▊         | 17/200 [00:30<04:54,  1.61s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:32<04:42,  1.55s/it, R2X=0.0214, Δ=1.04e-6]  2%|▏         | 3/200 [00:04<05:05,  1.55s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:05<04:49,  1.48s/it, R2X=0.0213, Δ=0.000114]  9%|▉         | 18/200 [00:34<05:46,  1.90s/it, R2X=0.0214, Δ=9.45e-7]
  2%|▎         | 5/200 [00:07<04:33,  1.40s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:08<04:09,  1.29s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:09<04:07,  1.28s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:10<03:58,  1.24s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:11<03:59,  1.26s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:12<03:42,  1.17s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:14<03:38,  1.15s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:15<03:50,  1.23s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:17<04:54,  1.58s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:19<04:55,  1.59s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:21<05:37,  1.82s/it, R2X=0.0214, Δ=1.42e-6]Reducing acceleration.
Degeneracy score: -0.3259171843333851
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 16/200 [00:23<05:22,  1.75s/it, R2X=0.0214, Δ=1.27e-6]  0%|          | 1/200 [00:01<05:34,  1.68s/it]  1%|          | 2/200 [00:03<05:18,  1.61s/it]  8%|▊         | 17/200 [00:26<06:11,  2.03s/it, R2X=0.0214, Δ=1.15e-6]  2%|▏         | 3/200 [00:04<05:06,  1.55s/it, R2X=0.0211, Δ=0.000215]  9%|▉         | 18/200 [00:27<05:50,  1.93s/it, R2X=0.0214, Δ=1.04e-6]  2%|▏         | 4/200 [00:06<05:08,  1.58s/it, R2X=0.0213, Δ=0.00012]   2%|▎         | 5/200 [00:08<05:15,  1.62s/it, R2X=0.0213, Δ=4.55e-5]  9%|▉         | 18/200 [00:30<05:08,  1.69s/it, R2X=0.0214, Δ=9.45e-7]
  3%|▎         | 6/200 [00:09<05:02,  1.56s/it, R2X=0.0213, Δ=2.41e-5]  4%|▎         | 7/200 [00:10<04:42,  1.46s/it, R2X=0.0213, Δ=1.22e-5]  4%|▍         | 8/200 [00:12<04:37,  1.44s/it, R2X=0.0214, Δ=9.72e-6]  4%|▍         | 9/200 [00:13<04:28,  1.41s/it, R2X=0.0214, Δ=3.72e-6]  5%|▌         | 10/200 [00:14<04:21,  1.38s/it, R2X=0.0214, Δ=5.13e-6]  6%|▌         | 11/200 [00:16<04:16,  1.36s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:17<04:11,  1.34s/it, R2X=0.0214, Δ=3.85e-6]  6%|▌         | 12/200 [00:18<04:54,  1.56s/it, R2X=0.0214, Δ=6.49e-8]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Reducing acceleration.
Degeneracy score: -0.32591718433338585
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:28,  1.35s/it]  1%|          | 2/200 [00:02<04:23,  1.33s/it]  2%|▏         | 3/200 [00:04<04:28,  1.36s/it, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:06<05:25,  1.66s/it, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:07<05:05,  1.57s/it, R2X=0.0213, Δ=4.16e-5]Degeneracy score: -0.3595495799183522
Number of T Cells: 2367
Number of T Cells in CTRL4: 35
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:08<04:42,  1.46s/it, R2X=0.0213, Δ=2.27e-5]  0%|          | 1/200 [00:01<04:20,  1.31s/it]  4%|▎         | 7/200 [00:10<04:28,  1.39s/it, R2X=0.0213, Δ=1.12e-5]  1%|          | 2/200 [00:02<04:08,  1.25s/it]  4%|▍         | 8/200 [00:11<04:15,  1.33s/it, R2X=0.0214, Δ=1.08e-5]  2%|▏         | 3/200 [00:03<04:06,  1.25s/it, R2X=0.0212, Δ=0.000212]  4%|▍         | 9/200 [00:12<04:02,  1.27s/it, R2X=0.0214, Δ=3.65e-6]  2%|▏         | 4/200 [00:05<04:08,  1.27s/it, R2X=0.0213, Δ=0.000114]  5%|▌         | 10/200 [00:13<04:13,  1.33s/it, R2X=0.0214, Δ=5.42e-6]  2%|▎         | 5/200 [00:06<04:22,  1.35s/it, R2X=0.0213, Δ=4.64e-5]   5%|▌         | 10/200 [00:15<04:53,  1.54s/it, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  3%|▎         | 6/200 [00:07<04:25,  1.37s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:09<04:10,  1.30s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:10<03:59,  1.25s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:11<03:53,  1.22s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:12<03:51,  1.22s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:13<03:47,  1.20s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:15<03:51,  1.23s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:17<04:33,  1.46s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:18<04:19,  1.40s/it, R2X=0.0214, Δ=1.61e-6]Degeneracy score: -0.3990366599882832
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 15/200 [00:20<04:52,  1.58s/it, R2X=0.0214, Δ=1.42e-6]  0%|          | 1/200 [00:01<05:26,  1.64s/it]  8%|▊         | 16/200 [00:21<04:47,  1.56s/it, R2X=0.0214, Δ=1.27e-6]  1%|          | 2/200 [00:03<05:20,  1.62s/it]  2%|▏         | 3/200 [00:04<05:21,  1.63s/it, R2X=0.0212, Δ=0.000212]  8%|▊         | 17/200 [00:24<05:34,  1.83s/it, R2X=0.0214, Δ=1.15e-6]  2%|▏         | 4/200 [00:06<05:46,  1.77s/it, R2X=0.0213, Δ=0.000114]  9%|▉         | 18/200 [00:26<05:41,  1.88s/it, R2X=0.0214, Δ=1.04e-6]  2%|▎         | 5/200 [00:08<06:07,  1.88s/it, R2X=0.0213, Δ=4.64e-5]   9%|▉         | 18/200 [00:29<04:55,  1.63s/it, R2X=0.0214, Δ=9.45e-7]
  3%|▎         | 6/200 [00:10<05:59,  1.85s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:12<05:44,  1.79s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:13<05:30,  1.72s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:15<05:26,  1.71s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:17<05:13,  1.65s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:18<05:05,  1.62s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:20<04:59,  1.59s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:22<05:56,  1.90s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:24<05:46,  1.86s/it, R2X=0.0214, Δ=1.61e-6]Reducing acceleration.
Degeneracy score: -0.3259171843333546
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 15/200 [00:27<06:26,  2.09s/it, R2X=0.0214, Δ=1.42e-6]  0%|          | 1/200 [00:01<05:47,  1.74s/it]  8%|▊         | 16/200 [00:29<06:16,  2.05s/it, R2X=0.0214, Δ=1.27e-6]  1%|          | 2/200 [00:03<06:00,  1.82s/it]  8%|▊         | 17/200 [00:32<07:03,  2.32s/it, R2X=0.0214, Δ=1.15e-6]  2%|▏         | 3/200 [00:05<06:08,  1.87s/it, R2X=0.0212, Δ=0.00022]  9%|▉         | 18/200 [00:34<06:45,  2.23s/it, R2X=0.0214, Δ=1.04e-6]  2%|▏         | 4/200 [00:07<06:13,  1.91s/it, R2X=0.0213, Δ=0.000108]  2%|▎         | 5/200 [00:09<05:59,  1.84s/it, R2X=0.0213, Δ=4.42e-5]   9%|▉         | 18/200 [00:37<06:16,  2.07s/it, R2X=0.0214, Δ=9.45e-7]
  3%|▎         | 6/200 [00:10<05:51,  1.81s/it, R2X=0.0213, Δ=2.38e-5]  4%|▎         | 7/200 [00:12<05:30,  1.71s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:14<05:17,  1.65s/it, R2X=0.0214, Δ=1.32e-5]  4%|▍         | 9/200 [00:15<05:09,  1.62s/it, R2X=0.0214, Δ=3.87e-6]  5%|▌         | 10/200 [00:17<05:03,  1.60s/it, R2X=0.0214, Δ=5.64e-6]  6%|▌         | 11/200 [00:18<04:56,  1.57s/it, R2X=0.0214, Δ=1.17e-6]  6%|▌         | 12/200 [00:20<04:57,  1.58s/it, R2X=0.0214, Δ=4.16e-6]  6%|▋         | 13/200 [00:22<05:43,  1.84s/it, R2X=0.0214, Δ=1.89e-6]  7%|▋         | 14/200 [00:24<05:19,  1.72s/it, R2X=0.0214, Δ=1.63e-6]  8%|▊         | 15/200 [00:26<05:51,  1.90s/it, R2X=0.0214, Δ=1.44e-6]Reducing acceleration.
Degeneracy score: -0.3259171843333726
  0%|          | 0/200 [00:00<?, ?it/s]  8%|▊         | 16/200 [00:28<05:40,  1.85s/it, R2X=0.0214, Δ=1.29e-6]  0%|          | 1/200 [00:01<06:09,  1.86s/it]  1%|          | 2/200 [00:03<06:01,  1.82s/it]  8%|▊         | 17/200 [00:30<06:24,  2.10s/it, R2X=0.0214, Δ=1.16e-6]  2%|▏         | 3/200 [00:05<06:07,  1.87s/it, R2X=0.0212, Δ=0.000243]  9%|▉         | 18/200 [00:32<06:15,  2.06s/it, R2X=0.0214, Δ=1.05e-6]  2%|▏         | 4/200 [00:07<05:48,  1.78s/it, R2X=0.0213, Δ=8.7e-5]    9%|▉         | 18/200 [00:35<06:01,  1.99s/it, R2X=0.0214, Δ=9.5e-7] 
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  2%|▎         | 5/200 [00:09<05:52,  1.81s/it, R2X=0.0213, Δ=4.17e-5]  3%|▎         | 6/200 [00:10<05:37,  1.74s/it, R2X=0.0213, Δ=2.28e-5]  4%|▎         | 7/200 [00:12<05:19,  1.65s/it, R2X=0.0213, Δ=1.1e-5]   4%|▍         | 8/200 [00:13<05:05,  1.59s/it, R2X=0.0214, Δ=1.12e-5]  4%|▍         | 9/200 [00:15<05:00,  1.57s/it, R2X=0.0214, Δ=3.7e-6]   5%|▌         | 10/200 [00:16<04:57,  1.56s/it, R2X=0.0214, Δ=5.41e-6]  5%|▌         | 10/200 [00:18<05:48,  1.83s/it, R2X=0.0214, Δ=8.06e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Reducing acceleration.
Degeneracy score: -0.3488965209973399
Number of Cytotoxic T Cells: 154
Number of Cytotoxic T Cells in CTRL4: 1
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:08,  1.25s/it]  1%|          | 2/200 [00:02<04:06,  1.24s/it]  2%|▏         | 3/200 [00:03<04:10,  1.27s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<04:02,  1.24s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:06<03:56,  1.21s/it, R2X=0.0213, Δ=4.64e-5] Degeneracy score: -0.39474638937794654
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:07<04:06,  1.27s/it, R2X=0.0213, Δ=2.45e-5]  0%|          | 1/200 [00:01<05:05,  1.53s/it]  4%|▎         | 7/200 [00:08<04:17,  1.33s/it, R2X=0.0214, Δ=1.07e-5]  1%|          | 2/200 [00:03<05:10,  1.57s/it]  4%|▍         | 8/200 [00:10<04:28,  1.40s/it, R2X=0.0214, Δ=1.36e-5]  2%|▏         | 3/200 [00:04<05:03,  1.54s/it, R2X=0.0212, Δ=0.000212]  4%|▍         | 9/200 [00:12<04:32,  1.43s/it, R2X=0.0214, Δ=3.89e-6]  2%|▏         | 4/200 [00:06<04:58,  1.52s/it, R2X=0.0213, Δ=0.000114]  5%|▌         | 10/200 [00:13<04:40,  1.48s/it, R2X=0.0214, Δ=5.66e-6]  2%|▎         | 5/200 [00:07<04:54,  1.51s/it, R2X=0.0213, Δ=4.64e-5]   6%|▌         | 11/200 [00:15<04:39,  1.48s/it, R2X=0.0214, Δ=1.13e-6]  3%|▎         | 6/200 [00:09<04:52,  1.51s/it, R2X=0.0213, Δ=2.45e-5]  6%|▌         | 12/200 [00:16<04:42,  1.50s/it, R2X=0.0214, Δ=4.19e-6]  4%|▎         | 7/200 [00:10<04:50,  1.50s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:12<04:52,  1.52s/it, R2X=0.0214, Δ=1.36e-5]  6%|▋         | 13/200 [00:19<05:31,  1.77s/it, R2X=0.0214, Δ=1.88e-6]  4%|▍         | 9/200 [00:13<04:40,  1.47s/it, R2X=0.0214, Δ=3.89e-6]  7%|▋         | 14/200 [00:20<05:06,  1.65s/it, R2X=0.0214, Δ=1.61e-6]  5%|▌         | 10/200 [00:14<04:21,  1.38s/it, R2X=0.0214, Δ=5.66e-6]  8%|▊         | 15/200 [00:22<05:27,  1.77s/it, R2X=0.0214, Δ=1.42e-6]  6%|▌         | 11/200 [00:15<04:14,  1.35s/it, R2X=0.0214, Δ=1.13e-6]  8%|▊         | 16/200 [00:23<04:59,  1.63s/it, R2X=0.0214, Δ=1.27e-6]  6%|▌         | 12/200 [00:17<04:10,  1.33s/it, R2X=0.0214, Δ=4.19e-6]  8%|▊         | 17/200 [00:25<05:14,  1.72s/it, R2X=0.0214, Δ=1.15e-6]  6%|▋         | 13/200 [00:19<04:47,  1.54s/it, R2X=0.0214, Δ=1.88e-6]  9%|▉         | 18/200 [00:27<04:50,  1.60s/it, R2X=0.0214, Δ=1.04e-6]  7%|▋         | 14/200 [00:20<04:38,  1.49s/it, R2X=0.0214, Δ=1.61e-6]  9%|▉         | 18/200 [00:28<04:51,  1.60s/it, R2X=0.0214, Δ=9.45e-7]
  8%|▊         | 15/200 [00:22<04:58,  1.61s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:23<04:21,  1.42s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:25<04:25,  1.45s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:26<03:57,  1.31s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:27<04:40,  1.54s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333806
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:51,  1.16it/s]  1%|          | 2/200 [00:01<02:44,  1.20it/s]  2%|▏         | 3/200 [00:02<02:44,  1.20it/s, R2X=0.0211, Δ=0.000215]  2%|▏         | 4/200 [00:03<02:45,  1.18it/s, R2X=0.0213, Δ=0.00012]   2%|▎         | 5/200 [00:04<02:42,  1.20it/s, R2X=0.0213, Δ=4.55e-5]  3%|▎         | 6/200 [00:05<02:44,  1.18it/s, R2X=0.0213, Δ=2.41e-5]Reducing acceleration.
Degeneracy score: -0.32591718433338573
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:05<02:43,  1.18it/s, R2X=0.0213, Δ=1.22e-5]  0%|          | 1/200 [00:01<03:47,  1.14s/it]  4%|▍         | 8/200 [00:07<03:03,  1.04it/s, R2X=0.0214, Δ=9.72e-6]  1%|          | 2/200 [00:02<03:33,  1.08s/it]  4%|▍         | 9/200 [00:08<03:13,  1.01s/it, R2X=0.0214, Δ=3.72e-6]  2%|▏         | 3/200 [00:03<03:31,  1.07s/it, R2X=0.0212, Δ=0.000239]  5%|▌         | 10/200 [00:09<03:19,  1.05s/it, R2X=0.0214, Δ=5.13e-6]  2%|▏         | 4/200 [00:04<03:27,  1.06s/it, R2X=0.0213, Δ=8.7e-5]    6%|▌         | 11/200 [00:10<03:21,  1.07s/it, R2X=0.0214, Δ=1.13e-6]  2%|▎         | 5/200 [00:05<03:28,  1.07s/it, R2X=0.0213, Δ=4.46e-5]  6%|▌         | 12/200 [00:11<03:22,  1.08s/it, R2X=0.0214, Δ=3.85e-6]  3%|▎         | 6/200 [00:06<03:33,  1.10s/it, R2X=0.0213, Δ=2.48e-5]  6%|▌         | 12/200 [00:12<03:18,  1.06s/it, R2X=0.0214, Δ=6.49e-8]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  4%|▎         | 7/200 [00:07<03:25,  1.06s/it, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:08<03:10,  1.01it/s, R2X=0.0214, Δ=1.22e-5]  4%|▍         | 9/200 [00:09<02:58,  1.07it/s, R2X=0.0214, Δ=3.73e-6]  5%|▌         | 10/200 [00:10<02:54,  1.09it/s, R2X=0.0214, Δ=5.55e-6]  5%|▌         | 10/200 [00:10<03:26,  1.09s/it, R2X=0.0214, Δ=8.18e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3595495799183573
Number of Memory T Cells: 2367
Number of Memory T Cells in CTRL4: 35
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:51,  1.17s/it]Degeneracy score: -0.3999244798059522
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  1%|          | 2/200 [00:02<04:12,  1.27s/it]  0%|          | 1/200 [00:01<04:40,  1.41s/it]  2%|▏         | 3/200 [00:03<04:17,  1.31s/it, R2X=0.0212, Δ=0.000212]  1%|          | 2/200 [00:02<04:18,  1.30s/it]  2%|▏         | 4/200 [00:05<04:13,  1.29s/it, R2X=0.0213, Δ=0.000114]  2%|▏         | 3/200 [00:04<04:26,  1.35s/it, R2X=0.0212, Δ=0.000212]  2%|▎         | 5/200 [00:06<04:02,  1.25s/it, R2X=0.0213, Δ=4.64e-5]   2%|▏         | 4/200 [00:05<04:22,  1.34s/it, R2X=0.0213, Δ=0.000114]  3%|▎         | 6/200 [00:07<04:05,  1.27s/it, R2X=0.0213, Δ=2.45e-5]  2%|▎         | 5/200 [00:06<04:10,  1.28s/it, R2X=0.0213, Δ=4.64e-5]   4%|▎         | 7/200 [00:09<04:14,  1.32s/it, R2X=0.0214, Δ=1.07e-5]  3%|▎         | 6/200 [00:08<04:25,  1.37s/it, R2X=0.0213, Δ=2.45e-5]  4%|▍         | 8/200 [00:10<04:26,  1.39s/it, R2X=0.0214, Δ=1.36e-5]  4%|▎         | 7/200 [00:09<04:27,  1.38s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 9/200 [00:11<04:18,  1.36s/it, R2X=0.0214, Δ=3.89e-6]  4%|▍         | 8/200 [00:11<04:38,  1.45s/it, R2X=0.0214, Δ=1.36e-5]  5%|▌         | 10/200 [00:13<04:29,  1.42s/it, R2X=0.0214, Δ=5.66e-6]  4%|▍         | 9/200 [00:12<04:41,  1.47s/it, R2X=0.0214, Δ=3.89e-6]  6%|▌         | 11/200 [00:14<04:33,  1.45s/it, R2X=0.0214, Δ=1.13e-6]  5%|▌         | 10/200 [00:14<04:46,  1.51s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 12/200 [00:16<04:23,  1.40s/it, R2X=0.0214, Δ=4.19e-6]  6%|▌         | 11/200 [00:15<04:31,  1.44s/it, R2X=0.0214, Δ=1.13e-6]  6%|▋         | 13/200 [00:18<05:02,  1.62s/it, R2X=0.0214, Δ=1.88e-6]  6%|▌         | 12/200 [00:16<04:28,  1.43s/it, R2X=0.0214, Δ=4.19e-6]  7%|▋         | 14/200 [00:19<04:42,  1.52s/it, R2X=0.0214, Δ=1.61e-6]  6%|▋         | 13/200 [00:18<04:42,  1.51s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:19<04:26,  1.43s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:21<05:06,  1.66s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:22<04:35,  1.50s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 15/200 [00:21<04:50,  1.57s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:23<04:37,  1.51s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:24<05:06,  1.67s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:25<04:36,  1.52s/it, R2X=0.0214, Δ=1.04e-6]  8%|▊         | 17/200 [00:25<04:58,  1.63s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:26<04:34,  1.51s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:28<04:44,  1.57s/it, R2X=0.0214, Δ=9.45e-7]
  9%|▉         | 18/200 [00:27<04:40,  1.54s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433336453
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:34,  1.29it/s]  1%|          | 2/200 [00:01<02:36,  1.26it/s]Reducing acceleration.
Degeneracy score: -0.3259171843333984
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:39,  1.10s/it]  2%|▏         | 3/200 [00:02<03:11,  1.03it/s, R2X=0.0211, Δ=0.000187]  1%|          | 2/200 [00:02<03:23,  1.03s/it]  2%|▏         | 4/200 [00:03<03:18,  1.01s/it, R2X=0.0212, Δ=0.000127]  2%|▏         | 3/200 [00:03<03:19,  1.01s/it, R2X=0.0212, Δ=0.000243]  2%|▎         | 5/200 [00:04<03:16,  1.01s/it, R2X=0.0213, Δ=5.27e-5]   2%|▏         | 4/200 [00:04<03:17,  1.01s/it, R2X=0.0213, Δ=8.95e-5]   3%|▎         | 6/200 [00:05<03:14,  1.00s/it, R2X=0.0213, Δ=2.8e-5]   2%|▎         | 5/200 [00:05<03:18,  1.02s/it, R2X=0.0213, Δ=4.23e-5]  4%|▎         | 7/200 [00:06<03:15,  1.01s/it, R2X=0.0213, Δ=9.23e-6]  3%|▎         | 6/200 [00:06<03:12,  1.01it/s, R2X=0.0213, Δ=2.3e-5]   4%|▍         | 8/200 [00:07<03:13,  1.01s/it, R2X=0.0213, Δ=1.6e-5]   4%|▎         | 7/200 [00:07<03:14,  1.01s/it, R2X=0.0213, Δ=1.11e-5]  4%|▍         | 9/200 [00:08<03:18,  1.04s/it, R2X=0.0213, Δ=3.05e-6]  4%|▍         | 8/200 [00:07<03:05,  1.03it/s, R2X=0.0214, Δ=1.14e-5]  5%|▌         | 10/200 [00:10<03:23,  1.07s/it, R2X=0.0214, Δ=7.22e-6]  4%|▍         | 9/200 [00:08<03:01,  1.05it/s, R2X=0.0214, Δ=3.79e-6]  5%|▌         | 10/200 [00:11<03:34,  1.13s/it, R2X=0.0214, Δ=8.22e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
  5%|▌         | 10/200 [00:10<03:13,  1.02s/it, R2X=0.0214, Δ=5.46e-6]  5%|▌         | 10/200 [00:10<03:24,  1.08s/it, R2X=0.0214, Δ=8.35e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.400298509927024
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:31,  1.06s/it]  1%|          | 2/200 [00:01<03:13,  1.02it/s]  2%|▏         | 3/200 [00:02<03:06,  1.05it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<03:02,  1.07it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<03:02,  1.07it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:59,  1.08it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<02:58,  1.08it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<03:14,  1.01s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:08<03:11,  1.00s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:09<02:59,  1.06it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:10<02:54,  1.08it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:11<02:48,  1.11it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:13<03:35,  1.15s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:14<03:32,  1.14s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:15<04:09,  1.35s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:16<03:41,  1.20s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:18<04:00,  1.31s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:19<03:40,  1.21s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:20<03:32,  1.17s/it, R2X=0.0214, Δ=9.45e-7]
Degeneracy score: -0.28637485060445306
Number of cDCs: 455
Number of cDCs in CTRL4: 8
Figure ThomsonDrop is done after 664.7592766284943 seconds.

Reducing acceleration.
Degeneracy score: -0.32591718433341205
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:21,  1.32s/it]  1%|          | 2/200 [00:02<04:29,  1.36s/it]  2%|▏         | 3/200 [00:03<04:11,  1.27s/it, R2X=0.0212, Δ=0.00024]  2%|▏         | 4/200 [00:05<04:00,  1.23s/it, R2X=0.0213, Δ=9.12e-5]  2%|▎         | 5/200 [00:06<03:56,  1.21s/it, R2X=0.0213, Δ=4.21e-5]  3%|▎         | 6/200 [00:07<03:58,  1.23s/it, R2X=0.0213, Δ=2.29e-5]  4%|▎         | 7/200 [00:08<03:50,  1.19s/it, R2X=0.0213, Δ=1.06e-5]  4%|▍         | 8/200 [00:09<03:49,  1.20s/it, R2X=0.0214, Δ=1.2e-5]   4%|▍         | 9/200 [00:11<03:48,  1.20s/it, R2X=0.0214, Δ=3.81e-6]  5%|▌         | 10/200 [00:12<03:49,  1.21s/it, R2X=0.0214, Δ=5.38e-6]  5%|▌         | 10/200 [00:13<04:13,  1.34s/it, R2X=0.0214, Δ=8.96e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.36744400838651753
Number of B Cells: 570
Number of B Cells in CTRL4: 7
Figure ThomsonDropPercents is done after 550.8846893310547 seconds.

poetry run fbuild ThomsonDropPercents
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:850: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:183: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/scanpy/preprocessing/_normalization.py:169: UserWarning: Received a view of an AnnData. Making a copy.
  view_to_actual(adata)
['Myeloid Suppressors' 'Classical Monocytes' 'Activated Monocytes'
 'Memory T Cells' 'Macrophages' 'Naive B Cells' 'Myeloid DCs'
 'Memory B Cells' 'Intermediate Monocytes' 'NK Cells' 'cDCs' 'pDCs'
 'Cytotoxic T Cells']
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<05:44,  1.73s/it]  1%|          | 2/200 [00:02<04:38,  1.41s/it]  2%|▏         | 3/200 [00:04<04:20,  1.32s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:05<04:08,  1.27s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:06<04:00,  1.23s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:07<03:56,  1.22s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:08<03:48,  1.19s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:09<03:45,  1.18s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:11<03:40,  1.16s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:12<03:35,  1.14s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:13<03:31,  1.12s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:14<03:30,  1.12s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:16<04:09,  1.34s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:17<04:01,  1.30s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:19<04:36,  1.50s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:20<04:17,  1.40s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:22<04:36,  1.51s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:23<04:17,  1.41s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:25<04:15,  1.40s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.325917184333423
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:02,  1.09it/s]  1%|          | 2/200 [00:01<02:49,  1.17it/s]  2%|▏         | 3/200 [00:02<02:52,  1.14it/s, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:03<02:54,  1.13it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:04<02:55,  1.11it/s, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:05<02:56,  1.10it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:06<02:54,  1.10it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:07<02:55,  1.09it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:08<02:53,  1.10it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:09<02:54,  1.09it/s, R2X=0.0214, Δ=5.42e-6]  5%|▌         | 10/200 [00:09<03:08,  1.01it/s, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3990366599882751
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:10,  1.05it/s]  1%|          | 2/200 [00:01<03:14,  1.02it/s]  2%|▏         | 3/200 [00:02<03:09,  1.04it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<03:14,  1.01it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<03:12,  1.01it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<03:03,  1.06it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<02:50,  1.13it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<02:42,  1.18it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:08<02:37,  1.21it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:29,  1.27it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:23,  1.32it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:10<02:21,  1.33it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:39,  1.17it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<02:28,  1.25it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<02:44,  1.12it/s, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:13<02:32,  1.21it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:14<02:46,  1.10it/s, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:15<02:32,  1.19it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:16<02:48,  1.08it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333411
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:34,  1.29it/s]  1%|          | 2/200 [00:01<02:17,  1.44it/s]  2%|▏         | 3/200 [00:02<02:18,  1.42it/s, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:02<02:19,  1.41it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:03<02:18,  1.41it/s, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:04<02:18,  1.40it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:04<02:17,  1.41it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:05<02:21,  1.36it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:06<02:22,  1.34it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:07<02:22,  1.33it/s, R2X=0.0214, Δ=5.42e-6]  5%|▌         | 10/200 [00:08<02:34,  1.23it/s, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3990366599881986
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:39,  1.25it/s]  1%|          | 2/200 [00:01<02:36,  1.26it/s]  2%|▏         | 3/200 [00:02<02:37,  1.25it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:41,  1.22it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:43,  1.19it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:49,  1.15it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:47,  1.15it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:44,  1.17it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:40,  1.19it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:33,  1.24it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:31,  1.25it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:30,  1.25it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:56,  1.06it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<02:47,  1.11it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:11,  1.03s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:14<02:59,  1.03it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:11,  1.05s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<02:56,  1.03it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:55,  1.04it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333749
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:41,  1.24it/s]  1%|          | 2/200 [00:01<02:34,  1.28it/s]  2%|▏         | 3/200 [00:02<02:36,  1.26it/s, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:03<02:33,  1.28it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:03<02:28,  1.32it/s, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:04<02:21,  1.37it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:05<02:19,  1.38it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:05<02:16,  1.40it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:06<02:16,  1.40it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:07<02:16,  1.40it/s, R2X=0.0214, Δ=5.42e-6]  5%|▌         | 10/200 [00:08<02:34,  1.23it/s, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3990366599883202
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:43,  1.22it/s]  1%|          | 2/200 [00:01<02:48,  1.17it/s]  2%|▏         | 3/200 [00:02<02:49,  1.16it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:50,  1.15it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:50,  1.14it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:46,  1.17it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:42,  1.19it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:38,  1.21it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:37,  1.21it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:31,  1.26it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:30,  1.25it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:33,  1.23it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:57,  1.05it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:12<02:49,  1.10it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:06,  1.01s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:14<02:53,  1.06it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:10,  1.04s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<02:55,  1.04it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:56,  1.03it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333558
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:34,  1.28it/s]  1%|          | 2/200 [00:01<02:29,  1.33it/s]  2%|▏         | 3/200 [00:02<02:37,  1.25it/s, R2X=0.0212, Δ=0.000243]  2%|▏         | 4/200 [00:03<02:35,  1.26it/s, R2X=0.0213, Δ=8.7e-5]    2%|▎         | 5/200 [00:03<02:29,  1.30it/s, R2X=0.0213, Δ=4.17e-5]  3%|▎         | 6/200 [00:04<02:26,  1.32it/s, R2X=0.0213, Δ=2.28e-5]  4%|▎         | 7/200 [00:05<02:26,  1.32it/s, R2X=0.0213, Δ=1.1e-5]   4%|▍         | 8/200 [00:06<02:25,  1.32it/s, R2X=0.0214, Δ=1.12e-5]  4%|▍         | 9/200 [00:06<02:23,  1.33it/s, R2X=0.0214, Δ=3.7e-6]   5%|▌         | 10/200 [00:07<02:19,  1.36it/s, R2X=0.0214, Δ=5.41e-6]  5%|▌         | 10/200 [00:08<02:37,  1.21it/s, R2X=0.0214, Δ=8.06e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.39474638937800616
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:46,  1.20it/s]  1%|          | 2/200 [00:01<02:42,  1.22it/s]  2%|▏         | 3/200 [00:02<02:42,  1.21it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:43,  1.20it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:48,  1.16it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:48,  1.15it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<02:49,  1.14it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:46,  1.16it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:43,  1.17it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:34,  1.23it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:31,  1.25it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:28,  1.26it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:53,  1.08it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<02:43,  1.14it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:05,  1.00s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:14<02:52,  1.06it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:14,  1.06s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<03:01,  1.00it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:57,  1.02it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843334045
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:34,  1.29it/s]  1%|          | 2/200 [00:01<02:35,  1.27it/s]  2%|▏         | 3/200 [00:02<02:36,  1.26it/s, R2X=0.0212, Δ=0.00024]  2%|▏         | 4/200 [00:03<02:33,  1.28it/s, R2X=0.0213, Δ=9.03e-5]  2%|▎         | 5/200 [00:03<02:32,  1.28it/s, R2X=0.0213, Δ=4.21e-5]  3%|▎         | 6/200 [00:04<02:31,  1.28it/s, R2X=0.0213, Δ=2.29e-5]  4%|▎         | 7/200 [00:05<02:21,  1.36it/s, R2X=0.0213, Δ=1.08e-5]  4%|▍         | 8/200 [00:05<02:11,  1.46it/s, R2X=0.0214, Δ=1.18e-5]  4%|▍         | 9/200 [00:06<02:04,  1.53it/s, R2X=0.0214, Δ=3.83e-6]  5%|▌         | 10/200 [00:07<01:59,  1.59it/s, R2X=0.0214, Δ=5.39e-6]  5%|▌         | 10/200 [00:07<02:25,  1.31it/s, R2X=0.0214, Δ=9.03e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3673937940424056
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:12,  1.50it/s]  1%|          | 2/200 [00:01<02:11,  1.51it/s]  2%|▏         | 3/200 [00:02<02:12,  1.49it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:02<02:20,  1.39it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:03<02:23,  1.36it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:04<02:26,  1.33it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:28,  1.30it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:05<02:29,  1.28it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:06<02:28,  1.28it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:07<02:30,  1.26it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:08<02:33,  1.23it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:35,  1.21it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:10<03:11,  1.03s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<03:03,  1.01it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:12<03:17,  1.07s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:13<03:01,  1.01it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:19,  1.09s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:15<03:02,  1.00s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<02:54,  1.04it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433342076
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:29,  1.34it/s]  1%|          | 2/200 [00:01<02:25,  1.36it/s]  2%|▏         | 3/200 [00:02<02:24,  1.37it/s, R2X=0.0212, Δ=0.00024]  2%|▏         | 4/200 [00:02<02:23,  1.37it/s, R2X=0.0213, Δ=8.69e-5]  2%|▎         | 5/200 [00:03<02:25,  1.34it/s, R2X=0.0213, Δ=4.47e-5]  3%|▎         | 6/200 [00:04<02:24,  1.34it/s, R2X=0.0213, Δ=2.44e-5]  4%|▎         | 7/200 [00:05<02:23,  1.34it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:05<02:22,  1.35it/s, R2X=0.0214, Δ=1.19e-5]  4%|▍         | 9/200 [00:06<02:21,  1.35it/s, R2X=0.0214, Δ=3.71e-6]  5%|▌         | 10/200 [00:07<02:25,  1.31it/s, R2X=0.0214, Δ=5.34e-6]  5%|▌         | 10/200 [00:08<02:36,  1.21it/s, R2X=0.0214, Δ=9.96e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.2871874831373677
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:35,  1.28it/s]  1%|          | 2/200 [00:01<02:36,  1.27it/s]  2%|▏         | 3/200 [00:02<02:38,  1.24it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<02:43,  1.20it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<02:46,  1.17it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:47,  1.16it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:05<02:47,  1.15it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:06<02:45,  1.16it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:42,  1.18it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:37,  1.21it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:09<02:36,  1.21it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:31,  1.24it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:11<02:58,  1.05it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:12<02:50,  1.09it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:13<03:13,  1.05s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:14<02:59,  1.02it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:15<03:20,  1.10s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:16<03:07,  1.03s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:17<03:00,  1.01it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433331646
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:37,  1.26it/s]  1%|          | 2/200 [00:01<02:33,  1.29it/s]  2%|▏         | 3/200 [00:02<02:34,  1.28it/s, R2X=0.0212, Δ=0.000236]  2%|▏         | 4/200 [00:03<02:32,  1.28it/s, R2X=0.0213, Δ=9.19e-5]   2%|▎         | 5/200 [00:03<02:33,  1.27it/s, R2X=0.0213, Δ=4.46e-5]  3%|▎         | 6/200 [00:04<02:34,  1.26it/s, R2X=0.0213, Δ=2.38e-5]  4%|▎         | 7/200 [00:05<02:34,  1.25it/s, R2X=0.0213, Δ=1.11e-5]  4%|▍         | 8/200 [00:06<02:40,  1.20it/s, R2X=0.0214, Δ=1.2e-5]   4%|▍         | 9/200 [00:07<02:37,  1.21it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:34,  1.23it/s, R2X=0.0214, Δ=5.48e-6]  5%|▌         | 10/200 [00:08<02:48,  1.12it/s, R2X=0.0214, Δ=9.31e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3804164299388583
Number of B Cells: 570
Number of B Cells in CTRL4: 7
Figure ThomsonDropPercents is done after 390.6210527420044 seconds.

