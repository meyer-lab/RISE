poetry run fbuild ThomsonDrop
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:850: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/anndata/_core/anndata.py:183: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
/home/nthomas/.cache/pypoetry/virtualenvs/sccp-uWtWZ1fM-py3.11/lib/python3.11/site-packages/scanpy/preprocessing/_normalization.py:169: UserWarning: Received a view of an AnnData. Making a copy.
  view_to_actual(adata)
['Myeloid Suppressors' 'Classical Monocytes' 'Activated Monocytes'
 'Memory T Cells' 'Macrophages' 'Naive B Cells' 'Myeloid DCs'
 'Memory B Cells' 'Intermediate Monocytes' 'NK Cells' 'cDCs' 'pDCs'
 'Cytotoxic T Cells']
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:26,  1.34s/it]  1%|          | 2/200 [00:02<03:59,  1.21s/it]  2%|▏         | 3/200 [00:03<03:57,  1.21s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:56,  1.21s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:44,  1.15s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:27,  1.07s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:20,  1.04s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:24,  1.06s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:10<03:30,  1.10s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:11<03:21,  1.06s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:11,  1.01s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:08,  1.00s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:14<03:43,  1.19s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:15<03:24,  1.10s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:17<03:48,  1.24s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:18<03:46,  1.23s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<04:08,  1.36s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:20<03:46,  1.24s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:22<03:44,  1.23s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433333994
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:44,  1.13s/it]  1%|          | 2/200 [00:02<03:37,  1.10s/it]  2%|▏         | 3/200 [00:02<03:08,  1.04it/s, R2X=0.0212, Δ=0.000244]  2%|▏         | 4/200 [00:03<03:08,  1.04it/s, R2X=0.0213, Δ=8.64e-5]   2%|▎         | 5/200 [00:05<03:17,  1.01s/it, R2X=0.0213, Δ=4.16e-5]  3%|▎         | 6/200 [00:06<03:13,  1.00it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:06<02:58,  1.08it/s, R2X=0.0213, Δ=1.12e-5]  4%|▍         | 8/200 [00:07<03:05,  1.04it/s, R2X=0.0214, Δ=1.08e-5]  4%|▍         | 9/200 [00:08<03:13,  1.01s/it, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:09<03:08,  1.01it/s, R2X=0.0214, Δ=5.42e-6]  5%|▌         | 10/200 [00:10<03:23,  1.07s/it, R2X=0.0214, Δ=7.88e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.399036659988338
Number of B Cells: 570
Number of B Cells in CTRL4: 7
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:03,  1.09it/s]  1%|          | 2/200 [00:01<03:03,  1.08it/s]  2%|▏         | 3/200 [00:02<03:19,  1.01s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:34,  1.09s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:38,  1.12s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:28,  1.07s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:16,  1.02s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:17,  1.03s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:25,  1.07s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:26,  1.09s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:19,  1.06s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:07,  1.00it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:14<03:45,  1.20s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:14<03:24,  1.10s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:16<03:54,  1.27s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:17<03:31,  1.15s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<03:56,  1.29s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:20<03:33,  1.17s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:21<03:38,  1.20s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433337247
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:09,  1.05it/s]  1%|          | 2/200 [00:01<02:50,  1.16it/s]  2%|▏         | 3/200 [00:02<03:08,  1.04it/s, R2X=0.0212, Δ=0.000234]  2%|▏         | 4/200 [00:03<03:19,  1.02s/it, R2X=0.0213, Δ=9.35e-5]   2%|▎         | 5/200 [00:04<03:05,  1.05it/s, R2X=0.0213, Δ=4.47e-5]  3%|▎         | 6/200 [00:05<03:00,  1.07it/s, R2X=0.0213, Δ=2.35e-5]  4%|▎         | 7/200 [00:06<03:10,  1.01it/s, R2X=0.0213, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<03:09,  1.01it/s, R2X=0.0214, Δ=1.26e-5]  4%|▍         | 9/200 [00:08<02:56,  1.08it/s, R2X=0.0214, Δ=3.87e-6]  5%|▌         | 10/200 [00:09<03:00,  1.05it/s, R2X=0.0214, Δ=5.48e-6]  5%|▌         | 10/200 [00:10<03:23,  1.07s/it, R2X=0.0214, Δ=9.72e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.34538158899113564
Number of Naive B Cells: 178
Number of Naive B Cells in CTRL4: 3
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:59,  1.11it/s]  1%|          | 2/200 [00:01<03:21,  1.02s/it]  2%|▏         | 3/200 [00:03<03:36,  1.10s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:41,  1.13s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:28,  1.07s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:15,  1.01s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:17,  1.02s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:25,  1.07s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:32,  1.11s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:17,  1.04s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:06,  1.01it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:11,  1.02s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:13<03:33,  1.14s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:15<03:30,  1.13s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:16<03:47,  1.23s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:17<03:36,  1.18s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<03:51,  1.27s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:20<03:36,  1.19s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:21<03:38,  1.20s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333935
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:50,  1.17it/s]  1%|          | 2/200 [00:01<02:49,  1.17it/s]  2%|▏         | 3/200 [00:02<03:09,  1.04it/s, R2X=0.0212, Δ=0.000233]  2%|▏         | 4/200 [00:03<03:11,  1.03it/s, R2X=0.0213, Δ=9.99e-5]   2%|▎         | 5/200 [00:04<02:56,  1.10it/s, R2X=0.0213, Δ=4.2e-5]   3%|▎         | 6/200 [00:05<03:03,  1.06it/s, R2X=0.0213, Δ=2.27e-5]  4%|▎         | 7/200 [00:06<03:15,  1.01s/it, R2X=0.0214, Δ=1.05e-5]  4%|▍         | 8/200 [00:07<03:12,  1.00s/it, R2X=0.0214, Δ=1.12e-5]  4%|▍         | 9/200 [00:08<02:57,  1.07it/s, R2X=0.0214, Δ=3.65e-6]  5%|▌         | 10/200 [00:09<03:03,  1.03it/s, R2X=0.0214, Δ=5.36e-6]  5%|▌         | 10/200 [00:10<03:23,  1.07s/it, R2X=0.0214, Δ=8.57e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.39965521203539706
Number of NK Cells: 686
Number of NK Cells in CTRL4: 10
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:17,  1.01it/s]  1%|          | 2/200 [00:01<03:04,  1.07it/s]  2%|▏         | 3/200 [00:02<03:13,  1.02it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:25,  1.05s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:35,  1.11s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:37,  1.12s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:29,  1.09s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:16,  1.02s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:19,  1.05s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:24,  1.07s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:26,  1.09s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:23,  1.08s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:14<04:00,  1.28s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:15<03:53,  1.26s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:17<04:08,  1.35s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:18<03:57,  1.29s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<04:05,  1.34s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:21<03:52,  1.28s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:22<03:46,  1.25s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433336875
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:35,  1.08s/it]  1%|          | 2/200 [00:02<03:23,  1.03s/it]  2%|▏         | 3/200 [00:02<02:59,  1.10it/s, R2X=0.0211, Δ=0.000203]  2%|▏         | 4/200 [00:03<03:07,  1.04it/s, R2X=0.0212, Δ=0.000118]  2%|▎         | 5/200 [00:04<03:17,  1.01s/it, R2X=0.0213, Δ=4.94e-5]   3%|▎         | 6/200 [00:05<03:05,  1.05it/s, R2X=0.0213, Δ=2.46e-5]  4%|▎         | 7/200 [00:06<02:59,  1.08it/s, R2X=0.0213, Δ=1.25e-5]  4%|▍         | 8/200 [00:07<03:11,  1.00it/s, R2X=0.0213, Δ=1.18e-5]  4%|▍         | 9/200 [00:08<03:09,  1.01it/s, R2X=0.0213, Δ=2.73e-6]  5%|▌         | 10/200 [00:09<02:55,  1.08it/s, R2X=0.0213, Δ=8.29e-6]  5%|▌         | 10/200 [00:10<03:22,  1.07s/it, R2X=0.0213, Δ=6.18e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.4293972130618145
Number of DCs: 668
Number of DCs in CTRL4: 13
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:32,  1.07s/it]  1%|          | 2/200 [00:01<03:09,  1.05it/s]  2%|▏         | 3/200 [00:02<03:14,  1.01it/s, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:25,  1.05s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:34,  1.10s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:25,  1.06s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:14,  1.01s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:17,  1.03s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:24,  1.07s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:18,  1.05s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:12,  1.02s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:07,  1.00it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:13<03:31,  1.13s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:14<03:25,  1.10s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:16<03:42,  1.20s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:17<03:33,  1.16s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:18<03:46,  1.24s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:19<03:36,  1.19s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:21<03:34,  1.18s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433334776
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:06,  1.07it/s]  1%|          | 2/200 [00:02<03:27,  1.05s/it]  2%|▏         | 3/200 [00:02<03:11,  1.03it/s, R2X=0.0211, Δ=0.000196]  2%|▏         | 4/200 [00:03<02:58,  1.10it/s, R2X=0.0212, Δ=0.000109]  2%|▎         | 5/200 [00:04<03:11,  1.02it/s, R2X=0.0213, Δ=6.35e-5]   3%|▎         | 6/200 [00:05<03:18,  1.02s/it, R2X=0.0213, Δ=2.53e-5]  4%|▎         | 7/200 [00:06<03:02,  1.05it/s, R2X=0.0213, Δ=1.21e-5]  4%|▍         | 8/200 [00:07<03:00,  1.06it/s, R2X=0.0213, Δ=1.31e-5]  4%|▍         | 9/200 [00:08<03:10,  1.00it/s, R2X=0.0213, Δ=2.77e-6]  5%|▌         | 10/200 [00:09<03:03,  1.04it/s, R2X=0.0214, Δ=8.47e-6]  5%|▌         | 10/200 [00:10<03:19,  1.05s/it, R2X=0.0214, Δ=9.26e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.4124486357746973
Number of pDCs: 213
Number of pDCs in CTRL4: 5
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<04:24,  1.33s/it]  1%|          | 2/200 [00:02<03:58,  1.21s/it]  2%|▏         | 3/200 [00:03<03:23,  1.03s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:11,  1.02it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:18,  1.02s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<02:49,  1.14it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<02:31,  1.27it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<02:18,  1.38it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:07<02:09,  1.47it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:08<02:04,  1.53it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:08<02:05,  1.51it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:09<02:02,  1.53it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:10<02:25,  1.29it/s, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:11<02:16,  1.36it/s, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:12<02:29,  1.24it/s, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:12<02:22,  1.29it/s, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:13<02:33,  1.19it/s, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:14<02:19,  1.30it/s, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:15<02:36,  1.17it/s, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843333864
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<03:14,  1.02it/s]  1%|          | 2/200 [00:01<02:50,  1.16it/s]  2%|▏         | 3/200 [00:02<03:06,  1.05it/s, R2X=0.0211, Δ=0.000215]  2%|▏         | 4/200 [00:03<03:18,  1.01s/it, R2X=0.0213, Δ=0.00012]   2%|▎         | 5/200 [00:04<03:11,  1.02it/s, R2X=0.0213, Δ=4.55e-5]  3%|▎         | 6/200 [00:05<03:00,  1.08it/s, R2X=0.0213, Δ=2.41e-5]  4%|▎         | 7/200 [00:06<02:46,  1.16it/s, R2X=0.0213, Δ=1.22e-5]  4%|▍         | 8/200 [00:07<02:52,  1.11it/s, R2X=0.0214, Δ=9.72e-6]  4%|▍         | 9/200 [00:08<03:06,  1.02it/s, R2X=0.0214, Δ=3.72e-6]  5%|▌         | 10/200 [00:09<02:47,  1.13it/s, R2X=0.0214, Δ=5.13e-6]  6%|▌         | 11/200 [00:10<03:02,  1.04it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:11<02:56,  1.07it/s, R2X=0.0214, Δ=3.85e-6]  6%|▌         | 12/200 [00:12<03:08,  1.00s/it, R2X=0.0214, Δ=6.49e-8]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3595495799183829
Number of T Cells: 2367
Number of T Cells in CTRL4: 35
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:40,  1.24it/s]  1%|          | 2/200 [00:01<03:09,  1.05it/s]  2%|▏         | 3/200 [00:02<03:20,  1.02s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<03:00,  1.08it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<03:00,  1.08it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:05<03:13,  1.00it/s, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:06<03:14,  1.01s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<02:56,  1.09it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:08<03:03,  1.04it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:09<03:04,  1.03it/s, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:10<02:50,  1.11it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:11<02:58,  1.05it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:12<03:18,  1.06s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:13<03:20,  1.08s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:15<03:36,  1.17s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:16<03:33,  1.16s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:17<03:49,  1.25s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:18<03:39,  1.21s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:20<03:26,  1.13s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433332706
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:15,  1.47it/s]  1%|          | 2/200 [00:01<03:04,  1.07it/s]  2%|▏         | 3/200 [00:02<02:50,  1.15it/s, R2X=0.0212, Δ=0.00022]  2%|▏         | 4/200 [00:03<02:53,  1.13it/s, R2X=0.0213, Δ=0.000108]  2%|▎         | 5/200 [00:04<02:37,  1.24it/s, R2X=0.0213, Δ=4.42e-5]   3%|▎         | 6/200 [00:05<02:51,  1.13it/s, R2X=0.0213, Δ=2.38e-5]  4%|▎         | 7/200 [00:06<03:07,  1.03it/s, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<02:49,  1.14it/s, R2X=0.0214, Δ=1.32e-5]  4%|▍         | 9/200 [00:08<03:03,  1.04it/s, R2X=0.0214, Δ=3.87e-6]  5%|▌         | 10/200 [00:08<02:51,  1.11it/s, R2X=0.0214, Δ=5.64e-6]  6%|▌         | 11/200 [00:09<02:53,  1.09it/s, R2X=0.0214, Δ=1.17e-6]  6%|▌         | 12/200 [00:11<03:04,  1.02it/s, R2X=0.0214, Δ=4.16e-6]  6%|▋         | 13/200 [00:12<03:27,  1.11s/it, R2X=0.0214, Δ=1.89e-6]  7%|▋         | 14/200 [00:13<03:27,  1.12s/it, R2X=0.0214, Δ=1.63e-6]  8%|▊         | 15/200 [00:14<03:43,  1.21s/it, R2X=0.0214, Δ=1.44e-6]  8%|▊         | 16/200 [00:16<03:35,  1.17s/it, R2X=0.0214, Δ=1.29e-6]  8%|▊         | 17/200 [00:17<03:51,  1.27s/it, R2X=0.0214, Δ=1.16e-6]  9%|▉         | 18/200 [00:18<03:35,  1.18s/it, R2X=0.0214, Δ=1.05e-6]  9%|▉         | 18/200 [00:20<03:23,  1.12s/it, R2X=0.0214, Δ=9.5e-7] 
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Reducing acceleration.
Degeneracy score: -0.3488965209973757
Number of Cytotoxic T Cells: 154
Number of Cytotoxic T Cells in CTRL4: 1
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:25,  1.03s/it]  1%|          | 2/200 [00:02<03:37,  1.10s/it]  2%|▏         | 3/200 [00:03<03:24,  1.04s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:03<03:04,  1.06it/s, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:04<03:11,  1.02it/s, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:20,  1.03s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:19,  1.03s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:07<03:06,  1.03it/s, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:08<03:04,  1.04it/s, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:12,  1.01s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:10,  1.01s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:11<02:55,  1.07it/s, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:13<03:32,  1.14s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:14<03:13,  1.04s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:15<03:28,  1.13s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:16<03:22,  1.10s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:17<03:35,  1.18s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:19<03:29,  1.15s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:20<03:26,  1.14s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.3259171843334247
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<03:57,  1.19s/it]  1%|          | 2/200 [00:02<03:56,  1.19s/it]  2%|▏         | 3/200 [00:03<03:20,  1.02s/it, R2X=0.0211, Δ=0.000215]  2%|▏         | 4/200 [00:04<03:18,  1.01s/it, R2X=0.0213, Δ=0.00012]   2%|▎         | 5/200 [00:05<03:26,  1.06s/it, R2X=0.0213, Δ=4.55e-5]  3%|▎         | 6/200 [00:06<03:13,  1.00it/s, R2X=0.0213, Δ=2.41e-5]  4%|▎         | 7/200 [00:07<03:02,  1.06it/s, R2X=0.0213, Δ=1.22e-5]  4%|▍         | 8/200 [00:08<03:11,  1.00it/s, R2X=0.0214, Δ=9.72e-6]  4%|▍         | 9/200 [00:09<03:09,  1.01it/s, R2X=0.0214, Δ=3.72e-6]  5%|▌         | 10/200 [00:09<02:56,  1.08it/s, R2X=0.0214, Δ=5.13e-6]  6%|▌         | 11/200 [00:10<03:01,  1.04it/s, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:11,  1.02s/it, R2X=0.0214, Δ=3.85e-6]  6%|▌         | 12/200 [00:13<03:23,  1.09s/it, R2X=0.0214, Δ=6.49e-8]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.3595495799183886
Number of Memory T Cells: 2367
Number of Memory T Cells in CTRL4: 35
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:53,  1.15it/s]  1%|          | 2/200 [00:01<03:20,  1.01s/it]  2%|▏         | 3/200 [00:03<03:36,  1.10s/it, R2X=0.0212, Δ=0.000212]  2%|▏         | 4/200 [00:04<03:34,  1.10s/it, R2X=0.0213, Δ=0.000114]  2%|▎         | 5/200 [00:05<03:27,  1.07s/it, R2X=0.0213, Δ=4.64e-5]   3%|▎         | 6/200 [00:06<03:14,  1.00s/it, R2X=0.0213, Δ=2.45e-5]  4%|▎         | 7/200 [00:07<03:20,  1.04s/it, R2X=0.0214, Δ=1.07e-5]  4%|▍         | 8/200 [00:08<03:28,  1.08s/it, R2X=0.0214, Δ=1.36e-5]  4%|▍         | 9/200 [00:09<03:37,  1.14s/it, R2X=0.0214, Δ=3.89e-6]  5%|▌         | 10/200 [00:10<03:24,  1.08s/it, R2X=0.0214, Δ=5.66e-6]  6%|▌         | 11/200 [00:11<03:10,  1.01s/it, R2X=0.0214, Δ=1.13e-6]  6%|▌         | 12/200 [00:12<03:13,  1.03s/it, R2X=0.0214, Δ=4.19e-6]  6%|▋         | 13/200 [00:14<03:43,  1.20s/it, R2X=0.0214, Δ=1.88e-6]  7%|▋         | 14/200 [00:15<03:28,  1.12s/it, R2X=0.0214, Δ=1.61e-6]  8%|▊         | 15/200 [00:16<04:05,  1.33s/it, R2X=0.0214, Δ=1.42e-6]  8%|▊         | 16/200 [00:17<03:42,  1.21s/it, R2X=0.0214, Δ=1.27e-6]  8%|▊         | 17/200 [00:19<04:17,  1.41s/it, R2X=0.0214, Δ=1.15e-6]  9%|▉         | 18/200 [00:20<03:58,  1.31s/it, R2X=0.0214, Δ=1.04e-6]  9%|▉         | 18/200 [00:22<03:47,  1.25s/it, R2X=0.0214, Δ=9.45e-7]
Reducing acceleration.
Degeneracy score: -0.32591718433341427
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<02:28,  1.34it/s]  1%|          | 2/200 [00:01<02:54,  1.13it/s]  2%|▏         | 3/200 [00:02<03:16,  1.00it/s, R2X=0.0211, Δ=0.000187]  2%|▏         | 4/200 [00:03<03:05,  1.06it/s, R2X=0.0212, Δ=0.000127]  2%|▎         | 5/200 [00:04<02:55,  1.11it/s, R2X=0.0213, Δ=5.27e-5]   3%|▎         | 6/200 [00:05<03:07,  1.04it/s, R2X=0.0213, Δ=2.8e-5]   4%|▎         | 7/200 [00:06<03:07,  1.03it/s, R2X=0.0213, Δ=9.23e-6]  4%|▍         | 8/200 [00:07<02:56,  1.09it/s, R2X=0.0213, Δ=1.6e-5]   4%|▍         | 9/200 [00:08<02:59,  1.06it/s, R2X=0.0213, Δ=3.05e-6]  5%|▌         | 10/200 [00:09<03:10,  1.00s/it, R2X=0.0214, Δ=7.22e-6]  5%|▌         | 10/200 [00:10<03:21,  1.06s/it, R2X=0.0214, Δ=8.22e-7]
/home/nthomas/scCP/sccp/factorization.py:43: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  X.uns["Pf2_weights"] = parafac2_output[0]
Degeneracy score: -0.286374850604439
Number of cDCs: 455
Number of cDCs in CTRL4: 8
Figure ThomsonDrop is done after 568.9741246700287 seconds.

